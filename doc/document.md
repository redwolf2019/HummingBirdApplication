# 《蜂鸟协议自动解析服务》

## 概念

- 蜂鸟(Hummingbird)寓意着快速灵活.
- 将设备的数据抽象成DP点(DataPoint数据点),与设备的数据交互其实就是对1~N个DP点组合的交互.

### 设计启发

- Linux系统里一切皆文件,那么物联网设备数据岂不是可以一切皆数据点?

## 适用范围

- Hex Binary

## DP点结构

### DP 点

| 起止符(2字节) | 标志位(2字节)         | 功能位(1字节) | 数据(N字节) |
| :------------ | --------------------- | ------------- | ----------- |
| 固定\r\ns     | 2 byte unsigned short | R/W/RW/X      | Hex bytes   |

#### 起止符

- 用于间隔多个连在一起的DP点

#### 标志位

- 用于区分不同的DP点类型

#### 功能位

- DP点支持的操作:只读,只写,读写,执行反馈

#### 数据

- DP点代表的数据:number,bool等信息

### 帧数据

| 帧数据长度(2字节)     | 设备编码(N字节) | DP点1     | DP点2     | ...  | DP点N     |
| --------------------- | --------------- | --------- | --------- | ---- | --------- |
| 2 byte unsigned short | String          | Hex bytes | Hex bytes | ...  | Hex bytes |

### 优势

- DP点动态组合,灵活可变

### 劣势

- DP点需要事先定义

### 约定
- 命令交互执行返回结果中，DP点功能位固定:`X`
- 数据位至少1字节：
    - 0x00:不支持的DP点
    - 0x01:执行失败
    - 0x02+xxxx:执行成功及返回结果

### 扩展

- 1byte=8bit,则可以牺牲标志位的范围,将标志位和功能为合为2byte,最高2bit:00,01,10,11分别代表功能位R,W,RW,X

## 代码演示





